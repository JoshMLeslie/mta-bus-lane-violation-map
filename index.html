<!DOCTYPE html>
<html>
	<head>
		<link
			rel="stylesheet"
			href="https://unpkg.com/leaflet@2.0.0-alpha/dist/leaflet.css"
			crossorigin=""
		/>
		<link rel="stylesheet" href="./main.css" />
		<script type="importmap">
			{
				"imports": {
					"leaflet": "https://unpkg.com/leaflet@2.0.0-alpha/dist/leaflet.js"
				}
			}
		</script>
	</head>
	<body>
		<div id="map"></div>
		<div id="side-bar">
			<div id="side-bar-content">
				<h1>NYC MTA</h1>
				<h1>Bus Lane Violations</h1>
				<p>
					Heat map of most recent aggregated bus lane violations (up to 1000),
					within the last month grouped by lat, lng
				</p>
				<h2>Source Data</h2>
				<p class="url">
					https://data.ny.gov/Transportation/MTA-Bus-Automated-Camera-Enforcement-Violations-Be/kh8p-hcbm/about_data
				</p>
				<h2>Query</h2>
				<pre class="code-block">
SELECT
  ROUND(violation_latitude, ${ROUND_ACCURACY}) AS lat,
  ROUND(violation_longitude, ${ROUND_ACCURACY}) AS lng, 
  count(*) AS violation_count
WHERE
  first_occurrence >= '${thirtyDaysAgo}'
  ${includeExempt ? '' : `AND NOT starts_with(violation_status, "EXEMPT")`}
GROUP BY 
  ROUND(violation_latitude, ${ROUND_ACCURACY}),
  ROUND(violation_longitude, ${ROUND_ACCURACY})
				</pre
				>
			</div>
		</div>
	</body>

	<script type="module" src="./main.js"></script>
</html>
